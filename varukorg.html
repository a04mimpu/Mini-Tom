<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Varukorg</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: #fffaf0;
    }

    /* Menyrad */
    .top-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #0069aa;
      padding: 10px 20px;
      color: white;
    }

    .nav-left, .nav-right {
      display: flex;
      align-items: center;
    }

    .nav-left div {
      margin-right: 25px;
      cursor: pointer;
    }

    .nav-left div:hover {
      text-decoration: underline;
    }

    .nav-right img {
      width: 24px;
      height: 24px;
    }

    h1 {
      text-align: center;
      margin-top: 40px;
      font-size: 28px;
    }

    .cart-icon {
      vertical-align: middle;
      margin-right: 10px;
    }

    .box {
      background: #e0ffe0;
      border: 2px solid #a0dca0;
      padding: 20px;
      margin: 20px auto;
      width: 60%;
      border-radius: 10px;
      font-size: 18px;
    }

    .check {
      font-size: 30px;
      color: green;
      margin-bottom: 10px;
    }

    .info-line {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <!-- Menyrad -->
  <div class="top-nav">
    <div class="nav-left">
      <div>Visma Proceedo</div>
      <div>Ink√∂p</div>
      <div>Alla best√§llningar</div>
      <div>Fakturor</div>
      <div>Uppf√∂ljning</div>
    </div>
    <div class="nav-right">
      <img src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png" alt="Varukorg">
    </div>
  </div>

  <!-- Rubrik med ikon -->
  <h1><img class="cart-icon" src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png" alt="Varukorg" width="30">Din varukorg</h1>

  <!-- Produkter -->
  <div class="box">
    <div class="check">‚úÖ</div>
    <div><strong>Produkt(er):</strong></div>
    <div id="produkt">-</div>
  </div>

  <!-- Leveransinformation -->
  <div class="box">
    <strong>Leverans till:</strong>
    <div class="info-line" id="chef">-</div>
    <div id="adress">-</div>
  </div>

  <script>
    // H√§mta data fr√•n localStorage
    const produkter = JSON.parse(localStorage.getItem("produkter")) || [];
    const chef = localStorage.getItem("mottagareNamn") || "Ok√§nd chef";
    const adress = localStorage.getItem("mottagareAdress") || "Ok√§nd adress";

    // Visa produkterna
    const produktEl = document.getElementById("produkt");
    if (produkter.length > 0) {
      produktEl.innerHTML = produkter.map(p => `‚úÖ ${p}`).join("<br>");
    } else {
      produktEl.innerText = "-";
    }

    // Visa chef och adress
    document.getElementById("chef").innerText = chef;
    document.getElementById("adress").innerText = adress;

    // üó£Ô∏è Robot-Tom pratar och √∂ppnar mejl
    const tts = new SpeechSynthesisUtterance();
    tts.lang = "sv-SE";
    tts.pitch = 1.1;
    tts.rate = 1;

    if (produkter.length > 0) {
      tts.text = `Jag har lagt ${produkter.join(", ")} i korgen. Leveransen g√•r till ${chef} p√• ${adress}. Jag skickar nu ett mejl till mottagande chef.`;
    } else {
      tts.text = "Inga produkter har lagts i korgen.";
    }

    tts.onend = () => {
      √∂ppnaOutlookMejl();
    };

    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(tts);

    // √ñppna Outlook med f√§rdigt mejl
    function √∂ppnaOutlookMejl() {
      const email = chef
        .toLowerCase()
        .replace(/[√•√§]/g, 'a')
        .replace(/√∂/g, 'o')
        .replace(/\s+/g, '.') + "@exempel.se";

      const subject = encodeURIComponent("Best√§llning fr√•n Tom");
      const body = encodeURIComponent(
        `Hej ${chef},\n\nF√∂ljande produkter har best√§llts:\n\n- ${produkter.join("\n- ")}\n\nLeveransadress:\n${adress}\n\nV√§nliga h√§lsningar,\nTom ‚Äì AI-assistent`
      );

      window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
    }
  </script>
</body>
</html>
